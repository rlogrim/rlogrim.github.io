---
layout: post_comments
title: 범례 위치 설정
parent: 차트 팁
published: true
output:
  md_document:
    variant: markdown_github
    preserve_yaml: true
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, 
  encoding = encoding, 
  output_file=paste0(Sys.Date(), "-", sub(".Rmd", ".md",inputFile)), 
  output_dir = "C:/Users/MINYOUNG/projects/ggsave/docs/차트 팁") })
---

# {{ page.title }}
{: .no_toc }

## 개요

이번 포스팅에서는 `ggplot2`를 사용하여 차트에서 범례의 위치를 다양하게
조정하는 방법을 소개합니다. 범례를 패널 안쪽, 패널 바깥의 오른쪽, 아래쪽
등 다양한 위치로 이동시킬 수 있으며, 이를 통해 차트의 가독성과 미적
요소를 동시에 향상시킬 수 있습니다. 이전에 [혼합형 그래프
작성](https://codebyday.github.io/ggsave/docs/%EC%B0%A8%ED%8A%B8%20%ED%8C%81/%ED%98%BC%ED%95%A9%ED%98%95%20%EA%B7%B8%EB%9E%98%ED%94%84%20%EC%9E%91%EC%84%B1.html)
글에서 만든 차트를 활용하겠습니다.

``` r
# 글꼴 설정
font_add("kopub", "C:/Users/.../AppData/Local/Microsoft/Windows/Fonts/Kopub dotum medium.ttf")

showtext_auto()
showtext_opts(dpi=300)

theme.size = 14

# 기본지도 그리기
base <- ggplot(data = data2) +
  geom_col(aes(x = 년도, y = `승객 수`, fill = "승객 수"), width = 0.6) +
  geom_line(aes(x = 년도, y = `전년 대비 승객 수 증감률` * coeff, color = "전년 대비 승객 수 증감률")) +
  scale_fill_manual(values = "gray40") +
  scale_color_manual(values = "gray70") +
  scale_x_continuous(n.breaks = 12) +
  scale_y_continuous(
    name = "승객 수(천명)",
    labels = scales::comma_format(),
    expand = expansion(mult=c(0, 0.3)),
    sec.axis = sec_axis(~./coeff, name = "전년 대비 승객 수 증감률(%)",
                        labels = scales::percent_format())
  ) +
  theme_bw(base_family="kopub", base_size=theme.size)

base
```

<img src="{{ site.baseurl }}/assets/images/범례-위치-설정/unnamed-chunk-1-1.png" width="80%" style="display: block; margin: auto;" alt="승객 수와 전년 대비 승객 수 증감률을 나타낸 그래프" />

## 패널 바깥의 오른쪽에 범례 배치하기

기본적으로 범례는 패널 바깥 오른쪽에 위치합니다. 범례의 시각적 품질을
개선하기 위해 아래 작업을 수행할 수 있습니다.

-   범례 제목 제거: 차트의 간결함을 위해 범례 제목을 숨깁니다
-   범례 아이템 높이 조정: 범례 아이템(legend keys)의 높이를 범례
    텍스트와 동일하게 설정합니다
-   범례 간 간격 조정: `legend.spacing`을 사용해 범례 요소 간의 간격을
    줄입니다

``` r
base +
  theme(
    legend.title = element_blank(), # 범례 제목 없앰
    legend.key.height = unit(rel(0.8), "pt"), # 범례 key 높이를 범례 글자 크기와 일치
    legend.spacing = unit(3, "pt"), # 범례 간 간격 조정
  )
```

<img src="{{ site.baseurl }}/assets/images/범례-위치-설정/unnamed-chunk-2-1.png" width="80%" style="display: block; margin: auto;" alt="패널 바깥의 오른쪽에 범례를 배치한 그래프" />

## 패널 바깥 아래쪽에 범례 배치하기

범례를 패널 아래로 이동하려면 `legend.position = "bottom"`을 사용하면
됩니다. 추가적인 설정 없이도 범례가 아래쪽에 깔끔하게 정렬됩니다. 필요한
경우 위의 범례 설정을 함께 사용해 시각적 완성도를 높일 수 있습니다.

``` r
base +
  theme(
    legend.title = element_blank(), # 범례 제목 없앰
    legend.key.height = unit(rel(0.8), "pt"), # 범례 아이템 크기를 범례 글자 크기와 일치
    legend.spacing = unit(3, "pt"), # 범례 간 간격 조정
    legend.position = "bottom"
  )
```

<img src="{{ site.baseurl }}/assets/images/범례-위치-설정/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto;" alt="패널 바깥의 아래쪽에 범례를 배치한 그래프" />

## 패널 안쪽 왼편 위에 범례 배치하기

범례를 패널 내부로 이동하려면 `legend.position`을 “inside”로 설정하고,
`legend.justification`으로 상대적인 위치를 지정해야 합니다.

``` r
base +
  theme(
    legend.title = element_blank(), # 범례 제목 없앰
    legend.key.height = unit(rel(0.8), "pt"), # 범례 key 높이를 범례 글자 크기와 일치
    legend.spacing = unit(3, "pt"), # 범례 간 간격 조정
    legend.position = "inside",
    legend.justification = c(0.05, 0.95),
  )
```

<img src="{{ site.baseurl }}/assets/images/범례-위치-설정/unnamed-chunk-4-1.png" width="80%" style="display: block; margin: auto;" alt="패널 안쪽 왼편 위에 범례를 배치한 그래프" />

## 범례 배경색 없애기

범례 배경색 기본은 흰색으로 지정되어 있습니다. 배경색을 제거하고
투명하게 만들기 위해, `legend.background = element_rect(fill=NA)`를
추가합니다. 이렇게 하면, 차트의 배경과 범례가 자연스럽게 어우러질 수
있습니다.

``` r
base +
  theme(
    legend.title = element_blank(), # 범례 제목 없앰
    legend.key.height = unit(rel(0.8), "pt"), # 범례 key 높이를 범례 글자 크기와 일치
    legend.spacing = unit(3, "pt"), # 범례 간 간격 조정
    legend.position = "inside",
    legend.justification = c(0.05, 0.95),
    legend.background = element_rect(fill=NA),
  )
```

<img src="{{ site.baseurl }}/assets/images/범례-위치-설정/unnamed-chunk-5-1.png" width="80%" style="display: block; margin: auto;" alt="범례 배경색을 없앤 그래프" />

이번 글을 통해 기본적인 범례 위치 설정과 함께, 범례 아이템의 높이 조정,
범례 간 간격 조절, 배경색 변경 등 다양한 세부 설정 방법을 익히셨을
겁니다. 차트를 제작하며 시각적으로 균형 잡힌 그래프를 만들어 보세요.
추가적인 스타일 설정이 궁금하다면, [theme 함수
이해하기](https://codebyday.github.io/ggsave/docs/%EC%B0%A8%ED%8A%B8%20%ED%8C%81/theme%20%ED%95%A8%EC%88%98%20%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0.html)
포스팅을 참고해 보세요!
