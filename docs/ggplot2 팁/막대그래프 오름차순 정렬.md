---
layout: post
title: 막대그래프 오름차순 정렬
parent: ggplot2 팁
published: true
---

# {{ page.title }}
{: .no_toc }

## 목차
{: .no_toc .text-delta }

1. TOC
{:toc}

---

## 그래프의 기본 정렬 순서

iris 데이터셋을 예시로 사용하겠습니다.

``` r
head(data)
```

    ## # A tibble: 3 × 5
    ##   종류       `꽃받침 길이` `꽃받침 너비` `꽃잎 길이` `꽃잎 너비`
    ##   <fct>              <dbl>         <dbl>       <dbl>       <dbl>
    ## 1 setosa              5.01          3.43        1.46       0.246
    ## 2 versicolor          5.94          2.77        4.26       1.33 
    ## 3 virginica           6.59          2.97        5.55       2.03

x축은 붓꽃 종류를, y축은 꽃받침 너비를 나타내는 막대그래프를 그려보겠습니다.

기본 그래프에서는 붓꽃 이름이 abc순으로 나타납니다.

``` r
ggplot(data=data, aes(x=종류, y=`꽃받침 너비`, label=`꽃받침 너비`)) +
  geom_col(width=0.6) +
  geom_text(vjust=-0.5) +
  scale_y_continuous(expand=expansion(mult=c(0, 0.1))) +
  coord_cartesian(ylim=c(2.5, 3.5)) +
  theme_bw()
```

<img src="/assets/images/막대그래프-오름차순-정렬/unnamed-chunk-2-1.png" width="70%" style="display: block; margin: auto;" />

## 막대그래프 오름/내림차순 정렬

꽃받침 너비가 넓은 순으로 막대그래프를 정렬하고 싶다면, 어떻게 해야 할까요?

기존 코드에서 `aes(x=종류)`를 ```aes(x=reorder(종류, -`꽃받침 너비`))```로
수정해 주면, x축에 텍스트가 나열되는 순서가 꽃받침 너비가 넓은 순으로 바뀝니다.

반대로, 꽃받침 너비가 좁은 순부터 정렬하고 싶다면 ```aes(x=reorder(종류,`꽃받침 너비`))```로 적어주면 됩니다.

``` r
ggplot(data=data, aes(x=reorder(종류, -`꽃받침 너비`), y=`꽃받침 너비`, label=`꽃받침 너비`)) +
  geom_col(width=0.6) +
  geom_text(vjust=-0.5) +
  scale_y_continuous(expand=expansion(mult=c(0, 0.1))) +
  coord_cartesian(ylim=c(2.5, 3.5)) +
  theme_bw()
```

<img src="/assets/images/막대그래프-오름차순-정렬/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;" />

## x축 제목 수정

그러나 `reorder` 함수를 써서 막대그래프 정렬 순서를 바꿀 경우, x축 제목이 'reorder(종류, -\`꽃받침 너비\`)'가 되는 문제가 생깁니다.

이때는 `scale_x_discrete` 함수를 이용해, x축 제목을 원하는 대로 변경하면 됩니다.

``` r
ggplot(data=data, aes(x=reorder(종류, -`꽃받침 너비`), y=`꽃받침 너비`, label=`꽃받침 너비`)) +
  geom_col(width=0.6) +
  geom_text(vjust=-0.5) +
  scale_x_discrete(name="종류") +
  scale_y_continuous(expand=expansion(mult=c(0, 0.1))) +
  coord_cartesian(ylim=c(2.5, 3.5)) +
  theme_bw()
```

<img src="/assets/images/막대그래프-오름차순-정렬/unnamed-chunk-4-1.png" width="70%" style="display: block; margin: auto;" />
